
var testCase = require('nodeunit').testCase;
var ImapParser = require('../lib/imap-parser').ImapParser;
var p = new ImapParser(ImapParser.RESPONSE);

function runner(str) {
  var b = new Buffer(str);

  return function() {
    p.execute( b );
    if (!p.isDone()) {
        throw new Error("Command Incomplete");
    }
  }
}

module.exports = testCase({
  setUp: function(cb) {
    p.reinitialize(ImapParser.RESPONSE);
    console.log('----------------------');
    cb();
  },
/*
  mailbox_flags_one: function(test) {
    test.doesNotThrow(runner('* FLAGS ()\r\n'));
    test.done();
  },
  mailbox_flags_two: function(test) {
    test.doesNotThrow(runner("* FLAGS (\\Noinferiors \\Noselect)\r\n"));
    test.done();
  },
  mailbox_list: function(test) {
    test.doesNotThrow(runner('* LIST () "A" "haha"\r\n'));
    test.done();
  },
  mailbox_list_two: function(test) {
    test.doesNotThrow(runner('* LIST () NIL "hahah"\r\n'));
    test.done();
  },
  mailbox_lsub: function(test) {
    test.doesNotThrow(runner('* LSUB (\\AHAHA) "B" "OMG"\r\n'));
    test.done();
  },
  mailbox_search: function(test) {
    test.doesNotThrow(runner("* SEARCH 12 43\r\n"));
    test.done();
  },
  mailbox_status: function(test) {
    test.doesNotThrow(runner("* STATUS INBOX (MESSAGES 12 RECENT 40 UNSEEN 4)\r\n"));
    test.done();
  },
*/
  body_1part: function(test) {
    test.doesNotThrow(runner('* 5 FETCH (BODY ("TEXT" "OMG" ("HI" "THERE" "hi" "there") "FLD-ID" "FLD-DESC" "7BIT" 1234 0987))\r\n'));
    test.done();
  },
  uid: function(test) {
    test.doesNotThrow(runner("* 5 FETCH (UID 1234)\r\n"));
    test.done();
  },
  rfc822_size: function(test) {
    test.doesNotThrow(runner('* 5 FETCH (RFC822.SIZE 12432)\r\n'));
    test.done();
  },
  rfc822_text: function(test) {
    test.doesNotThrow(runner('* 5 FETCH (RFC822.TEXT "kshfda")\r\n'));
    test.done();
  },
  rfc822: function(test) {
    test.doesNotThrow(runner("* 5 FETCH (RFC822.HEADER NIL)\r\n"));
    test.done();
  },
  internaldate: function(test) {
    test.doesNotThrow(runner('* 5 FETCH (INTERNALDATE "10-Jan-2000 10:11:12 +0500")\r\n'));
    test.done();
  }

});
